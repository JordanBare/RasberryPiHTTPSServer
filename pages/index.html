<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="author" content="Jordan Bare">
    <meta name="keywords" content="encryption, Boost Asio">
    <meta name="description" content="">
    <title>Black Sun</title>
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <style>
        .textcol{color:#7E8889}
        .cenbackcol{background-color:#142634}
        .center{margin:0 auto;width:80%}
        nav ul{list-style-type:none;margin:0;padding:0;overflow:hidden}
        nav li a{display:block;color:white;text-align:center;padding:14px 16px;text-decoration:none}
        nav li a:hover{background-color:#111}

        button{display:inline-block;text-align:center;text-decoration:none}
        table{table-layout:fixed;width:100%}
        td button{width:100%;padding:16px}
        td button:hover{background-color:#111;color:#CC7832}
        td{width:33%}
    </style>
    <script>
        window.onload = function(){
            var xhttp = new XMLHttpRequest();
            handleBlogFetch(xhttp);
            xhttp.open("GET", "/recentblog", true);
            xhttp.send();
        }

        function loadDoc(resource){
            var xhttp = new XMLHttpRequest();
            xhttp.onreadystatechange = function() {
                if(xhttp.readyState === 4 && xhttp.status === 200){
                    document.getElementById("content").innerHTML = this.responseText;
                }};
            xhttp.open("GET", resource, true);
            xhttp.send();
        }
        function notZero(blogId){
            return blogId != 0;

        }
        function handleBlogFetch(xhttp){
            xhttp.onreadystatechange = function () {
                if (xhttp.readyState === 4 && xhttp.status === 200) {
                    var blog = JSON.parse(this.responseText).value0;
                    var formattedBlog = "<article><h2>" + blog.value0 + "</h2><h3>" + blog.value1 + "</h3><p>" + blog.value2 + "</p></article>";
                    if (notZero(blog.value3)) {
                        formattedBlog += formatBlogButton(blog.value3, "Previous");
                    }
                    if (notZero(blog.value4)) {
                        formattedBlog += formatBlogButton(blog.value4, "Next");
                    }
                    document.getElementById("content").innerHTML = formattedBlog;
                }
            };
        }
        function formatBlogButton(blogId, type){
            return "<button onclick=\"loadBlog(\'" + blogId + "\')\">" + type + "</button>";
        }
        function loadBlog(blogToRequest){
            if(notZero(blogToRequest)) {
                var xhttp = new XMLHttpRequest();
                handleBlogFetch(xhttp);
                xhttp.open("GET", blogToRequest, true);
                xhttp.send();
            }
        }
        function loadBlogIndex(){
            var xhttp = new XMLHttpRequest();
            xhttp.onreadystatechange = function () {
                if (xhttp.readyState === 4 && xhttp.status === 200) {
                    var blogs = JSON.parse(this.responseText).value0;

                    document.getElementById("content").innerHTML = formattedBlog;
                }
            };
            xhttp.open("GET", "/blogs", true);
            xhttp.send();
        }
    </script>
</head>
<body style="background-color:#333">
<div>
    <div class="center cenbackcol">
        <nav>
            <ul>
                <li style="float:left"><a href="#" >Jordan Bare - Developer</a></li>
                <li style="float:right"><a href="#" onclick="loadDoc('/blogs')">Blogs</a></li>
                <li style="float:right"><a href="#" onclick="loadDoc('/about')">About</a></li>
            </ul>
        </nav>
        <div id="content" class="textcol"></div>
        <footer></footer>
    </div>
</div>
</body>
</html>